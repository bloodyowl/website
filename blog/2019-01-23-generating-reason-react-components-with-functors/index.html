<!DOCTYPE html><html lang="en"><head><title data-react-helmet="true">Generating ReasonReact components with functors</title><meta data-react-helmet="true" name="description" value="Front-end developer and designer. ReasonML, ReasonReact, ReactJS."/><meta data-react-helmet="true" charset="UTF-8"/><meta data-react-helmet="true" content="w75-P-0ywXWkyZvYPbkSM3VSM2hny25UrfeiWJt3B1k" name="google-site-verification"/><meta data-react-helmet="true" content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/><meta data-react-helmet="true" content="summary_large_image" name="twitter:card"/><meta data-react-helmet="true" content="website" property="og:type"/><meta data-react-helmet="true" content="https://bloodyowl.io/public/assets/images/share.jpg" property="og:image"/><meta data-react-helmet="true" content="https://bloodyowl.io/public/assets/images/share.jpg" name="twitter:image"/><meta data-react-helmet="true" content="@bloodyowl" name="twitter:site"/><meta data-react-helmet="true" content="1500" property="og:image:width"/><meta data-react-helmet="true" content="777" property="og:image:height"/><link data-react-helmet="true" href="/public/assets/images/favicon.png" rel="shortcut icon"/><link data-react-helmet="true" href="https://bloodyowl.io/blog/2019-01-23-generating-reason-react-components-with-functors/" rel="canonical"/><style data-react-helmet="true" >@import url("//hello.myfonts.net/count/3cae5f")</style><script data-react-helmet="true" >window.beOpAsyncInit = function() {
        BeOpSDK.init({
          account: "556e1d2772a6b60100844051"
        });
        BeOpSDK.watch();
      };</script><script data-react-helmet="true" async="true" src="https://widget.beop.io/sdk.js"></script></head><div id="root"><style data-emotion-rpcss="dan8u4 p0hxbs 1sk4geg 12as1jd inii90 kk4a7b 16cj527 1moa3kc 18av5pk 1jtjujg j1f6xt a7hgs6 1h80fpx 1o4tcrz 68a2lg 1q7rfvt gghbgz 18z74vx 1qdfdal">pre{padding:10px 20px;background-color:#F4F7F8;overflow-x:auto;-webkit-overflow-scrolling:touch;font-size:16px;border-left-width:2px;border-left-color:#46515B;border-left-style:solid;}code{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:0.85em;line-height:1;}.hljs-keyword{color:#DA6BB5;}.hljs-constructor{color:#DD792B;}.hljs-identifier{color:#1E9EA7;}.hljs-module-identifier{color:#C84682;}.hljs-string{color:#3BA1C8;}.hljs-comment{color:#aaa;}.hljs-operator{color:#DA6BB5;}.hljs-attribute{color:#4CB877;}table{width:100%;text-align:center;}table thead th{background-color:#E4EBEE;padding:10px 0;}blockquote{opacity:0.6;border-left:4px solid #46515B;margin:0;padding:0 20px;}@font-face{font-family:HelveticaNowDisplay;src:url("/public/assets/webfonts/regular.woff2"),url("/public/assets/webfonts/regular.woff");font-style:normal;font-weight:400;font-display:swap;}@font-face{font-family:HelveticaNowDisplay;src:url("/public/assets/webfonts/bold.woff2"),url("/public/assets/webfonts/bold.woff");font-style:normal;font-weight:700;font-display:swap;}body{padding:0;margin:0;background-color:#fff;font-family:HelveticaNowDisplay,"Helvetica Neue",Helvetica,Arial,sans-serif;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;overflow-x:hidden;}#root{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}html{color:#46515B;font-size:1em;line-height:1.4;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:border-box;}</style><style data-emotion-rpcss="1lm8k0f">.rpcss-1lm8k0f{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;}</style><div class="rpcss-1lm8k0f"><style data-emotion-rpcss="14wlb7f">.rpcss-14wlb7f{background-color:#E4EBEE;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}@media (max-width:620px){.rpcss-14wlb7f{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}}</style><div class="rpcss-14wlb7f"><style data-emotion-rpcss="48zunz">.rpcss-48zunz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;color:#46515B;-webkit-text-decoration:none;text-decoration:none;}</style><a class="rpcss-48zunz" href="/"><style data-emotion-rpcss="19jaiin">.rpcss-19jaiin{margin-right:10px;margin-left:20px;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;}</style><img class="rpcss-19jaiin" alt="" height="32" src="/public/assets/images/owl.svg" width="32"/><style data-emotion-rpcss="16ucz1n">.rpcss-16ucz1n{padding:20px 20px 23px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div aria-level="1" class="rpcss-16ucz1n" role="heading"><style data-emotion-rpcss="x6blf3">.rpcss-x6blf3{font-weight:700;margin-right:10px;white-space:nowrap;}</style><div class="rpcss-x6blf3">Matthias Le Brun</div><div>@bloodyowl</div></div></a><style data-emotion-rpcss="7nltf6">.rpcss-7nltf6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}@media (max-width:620px){.rpcss-7nltf6{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;background-color:#D4E1E6;}}</style><div class="rpcss-7nltf6"><style data-emotion-rpcss="143gsgu">.rpcss-143gsgu{padding:20px 20px 23px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-text-decoration:none;text-decoration:none;color:#46515B;text-align:center;font-weight:700;}@media (max-width:620px){.rpcss-143gsgu{-webkit-flex-basis:33.333%;-ms-flex-preferred-size:33.333%;flex-basis:33.333%;padding:10px 20px 13px;}}</style><a class="rpcss-143gsgu" href="/blog/">Blog</a><style data-emotion-rpcss="1o16z30">.rpcss-1o16z30{padding:20px 20px 23px;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-text-decoration:none;text-decoration:none;color:#46515B;text-align:center;}@media (max-width:620px){.rpcss-1o16z30{-webkit-flex-basis:33.333%;-ms-flex-preferred-size:33.333%;flex-basis:33.333%;padding:10px 20px 13px;}}</style><a class="rpcss-1o16z30" href="https://twitter.com/bloodyowl">Twitter</a><a class="rpcss-1o16z30" href="https://github.com/bloodyowl">GitHub</a></div></div><style data-emotion-rpcss="12z655i">.rpcss-12z655i{max-width:600px;padding:0 10px;margin:20px auto;width:100%;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}</style><div class="rpcss-12z655i"><style data-emotion-rpcss="apovzu">.rpcss-apovzu{margin:0;font-size:48px;margin-top:50px;margin-bottom:10px;line-height:1.15;}</style><h1 class="rpcss-apovzu">Generating ReasonReact components with functors</h1><style data-emotion-rpcss="12xm3b2">.rpcss-12xm3b2{font-size:14px;opacity:0.5;margin-bottom:50px;}</style><div class="rpcss-12xm3b2">2019/01/23</div><style data-emotion-rpcss="b2zag1">.rpcss-b2zag1{margin-top:40px;font-size:18px;}.rpcss-b2zag1 a{color:#135EFF;}.rpcss-b2zag1 a:hover{color:#13A3FF;}</style><div class="rpcss-b2zag1"><p>In JavaScript, React components can either be function or classes. This makes it easy to create functions that return components (factories if you will).</p>
<p>With ReasonReact though, if you want to use them with JSX, components need to be modules containing a <code>make</code> function, which is a much more static construct.</p>
<p>Fortunately, Reason (through OCaml) has a great feature which is called functors. Think of it as a <strong>module function</strong>: it <strong>takes a module as parameter and returns a module</strong>.</p>
<h2>The syntax</h2>
<pre><code class="language-reason"><span class="hljs-keyword">module</span> <span class="hljs-module-identifier">Make</span> = (<span class="hljs-module-identifier">Param</span>: <span class="hljs-module-identifier">ParamType</span>) =&gt; {
  <span class="hljs-comment">/* contents of the module to return */</span>
};
</code></pre>
<p>Let's define a <code>ParamType</code> first:</p>
<pre><code class="language-reason"><span class="hljs-keyword">module</span> <span class="hljs-keyword">type</span> <span class="hljs-module-identifier">ParamType</span> = {
  <span class="hljs-keyword">type</span> t;
  <span class="hljs-keyword">let</span> name: string;
  <span class="hljs-keyword">let</span> render: t =&gt; <span class="hljs-module-identifier">React</span>.reactElement;
};
</code></pre>
<p>Now, let's create our functor. The following example is very short and now really useful, its goal is simply to show the syntax. Where functors shine is with more complicated components, where you just want to write a simple configuration to generate a component (e.g. big virtualised, paginated lists, sortables etc.)</p>
<pre><code class="language-reason"><span class="hljs-keyword">module</span> <span class="hljs-module-identifier">Make</span> = (<span class="hljs-module-identifier">Param</span>: <span class="hljs-module-identifier">ParamType</span>) =&gt; {
  <span class="hljs-keyword">type</span> state = {
    value: <span class="hljs-module-identifier">Param</span>.t,
  };
  <span class="hljs-keyword">let</span> component = <span class="hljs-module-identifier">React</span>.reducerComponent(<span class="hljs-string">&quot;Demo&quot;</span> <span class="hljs-operator">++</span> <span class="hljs-module-identifier">Param</span>.name);
  <span class="hljs-keyword">let</span> make = (~value: <span class="hljs-module-identifier">Param</span>.t, _) =&gt; {
    <span class="hljs-operator">...</span>component,
    initialState: () =&gt; {value: value},
    reducer: ((), _state) =&gt; <span class="hljs-module-identifier">React</span>.<span class="hljs-constructor">NoUpdate</span>,
    render: ({state}) =&gt;
      &lt;div style={<span class="hljs-module-identifier">ReactDOMRe</span>.<span class="hljs-module-identifier">Style</span>.make(~fontSize=<span class="hljs-string">&quot;32px&quot;</span>, ())}&gt;
        <span class="hljs-comment">/* some markup */</span>
         {<span class="hljs-module-identifier">Param</span>.render(state.value)} &lt;/div&gt;,
  };
};
</code></pre>
<p>Now, in order to create a component, we just have to create a module with <code>Make</code>:</p>
<pre><code class="language-reason"><span class="hljs-keyword">module</span> <span class="hljs-module-identifier">IntValue</span> =
  <span class="hljs-module-identifier">Make</span>({
    <span class="hljs-keyword">type</span> t = int;
    <span class="hljs-keyword">let</span> name = <span class="hljs-string">&quot;Int&quot;</span>;
    <span class="hljs-keyword">let</span> render = x =&gt; x<span class="hljs-operator">-&gt;</span>string_of_int<span class="hljs-operator">-&gt;</span><span class="hljs-module-identifier">React</span>.string;
  });

<span class="hljs-module-identifier">ReactDOMRe</span>.renderToElementWithId(&lt;<span class="hljs-module-identifier">IntValue</span> value=<span class="hljs-number">2</span> /&gt;, <span class="hljs-string">&quot;preview&quot;</span>);
</code></pre>
<p><a href="https://reasonml.github.io/en/try?rrjsx=true&amp;reason=LYewJgrgNgpgBAFwJ4Ad4AUCGAnTwAqq8AvHAN4BQciRiA3FXLAnAHZ4wBccAzgtgEtWAcwbVmcbDFZgY2bi2IA+OACUYmHiFbrMAYwQA6KfoQBRWMGkIGAXwYVQkWHACymANYk4ACiy5gbn88QjQASjhlckZkNF4ETARvMgA3TCgILjhg4EMEe0YJPRBgFG1rSLUNLR0NA2MYSD05AGESstZrHwAiABEYUG64AGph7Jw8Q3YrMLEmGBZgT28fAD80jKycvIAaOAB9CKjKampDc+LS8tYEHcZqIQEEAXSAZQSk7h8jlVT0zO4G0ytjup0kjQgzXkvm+e32fESMB+VU02l09QAciAAKooMCI0GnKQyORfMgIpK2H73U4AHjAAhS8SQsGIZHRCF6AHlXOpDO8WTBDEsvGsAGbaBCvAQALxgxG6AGYAEwoAAe3T23zCtiUNLBAHoAFS8ErwJbYDwQFBwI0G-VgsjbYmybA+ClCoFI2xwWkGhkpJSEgoFJzQeAASRuADV-iRGO5RSdTrF4Io4EIbDSJNNvN0owhunNxAtwSTsJU1ZEVGqALRKPiCET7EBi-aZ+u6GocwyNoSiRhUhwc7m8oUuuT4EAWAbWADqTwAFhGwD5aQXY5s4F7iMq4Aag3BuigpCkBDAAO7dWYUIA">Test it on the ReasonML playground</a></p>
</div><style data-emotion-rpcss="sq4ju6">.rpcss-sq4ju6{padding:10px 0;}</style><div class="rpcss-sq4ju6"><div class="BeOpWidget"></div></div></div><style data-emotion-rpcss="18aspvx">.rpcss-18aspvx{background-color:#46515B;color:#fff;text-align:center;padding:20px;font-size:14px;}</style><div class="rpcss-18aspvx">Copyright 2020 - Matthias Le Brun</div></div></div><script id="initialData" type="text/data">{"lists":{"RE_PRIVATE_NONE":true},"items":{"k":"blog","v":{"k":"2019-01-23-generating-reason-react-components-with-functors","v":{"_0":{"TAG":0,"_0":{"slug":"2019-01-23-generating-reason-react-components-with-functors","filename":"2019-01-23-generating-reason-react-components-with-functors","title":"Generating ReasonReact components with functors","date":"Wed, 23 Jan 2019 00:00:00 GMT","draft":false,"meta":{"date":"2019-01-23T00:00:00.000Z","title":"Generating ReasonReact components with functors"},"body":"<p>In JavaScript, React components can either be function or classes. This makes it easy to create functions that return components (factories if you will).</p>\n<p>With ReasonReact though, if you want to use them with JSX, components need to be modules containing a <code>make</code> function, which is a much more static construct.</p>\n<p>Fortunately, Reason (through OCaml) has a great feature which is called functors. Think of it as a <strong>module function</strong>: it <strong>takes a module as parameter and returns a module</strong>.</p>\n<h2>The syntax</h2>\n<pre><code class=\"language-reason\"><span class=\"hljs-keyword\">module</span> <span class=\"hljs-module-identifier\">Make</span> = (<span class=\"hljs-module-identifier\">Param</span>: <span class=\"hljs-module-identifier\">ParamType</span>) =&gt; {\n  <span class=\"hljs-comment\">/* contents of the module to return */</span>\n};\n</code></pre>\n<p>Let's define a <code>ParamType</code> first:</p>\n<pre><code class=\"language-reason\"><span class=\"hljs-keyword\">module</span> <span class=\"hljs-keyword\">type</span> <span class=\"hljs-module-identifier\">ParamType</span> = {\n  <span class=\"hljs-keyword\">type</span> t;\n  <span class=\"hljs-keyword\">let</span> name: string;\n  <span class=\"hljs-keyword\">let</span> render: t =&gt; <span class=\"hljs-module-identifier\">React</span>.reactElement;\n};\n</code></pre>\n<p>Now, let's create our functor. The following example is very short and now really useful, its goal is simply to show the syntax. Where functors shine is with more complicated components, where you just want to write a simple configuration to generate a component (e.g. big virtualised, paginated lists, sortables etc.)</p>\n<pre><code class=\"language-reason\"><span class=\"hljs-keyword\">module</span> <span class=\"hljs-module-identifier\">Make</span> = (<span class=\"hljs-module-identifier\">Param</span>: <span class=\"hljs-module-identifier\">ParamType</span>) =&gt; {\n  <span class=\"hljs-keyword\">type</span> state = {\n    value: <span class=\"hljs-module-identifier\">Param</span>.t,\n  };\n  <span class=\"hljs-keyword\">let</span> component = <span class=\"hljs-module-identifier\">React</span>.reducerComponent(<span class=\"hljs-string\">&quot;Demo&quot;</span> <span class=\"hljs-operator\">++</span> <span class=\"hljs-module-identifier\">Param</span>.name);\n  <span class=\"hljs-keyword\">let</span> make = (~value: <span class=\"hljs-module-identifier\">Param</span>.t, _) =&gt; {\n    <span class=\"hljs-operator\">...</span>component,\n    initialState: () =&gt; {value: value},\n    reducer: ((), _state) =&gt; <span class=\"hljs-module-identifier\">React</span>.<span class=\"hljs-constructor\">NoUpdate</span>,\n    render: ({state}) =&gt;\n      &lt;div style={<span class=\"hljs-module-identifier\">ReactDOMRe</span>.<span class=\"hljs-module-identifier\">Style</span>.make(~fontSize=<span class=\"hljs-string\">&quot;32px&quot;</span>, ())}&gt;\n        <span class=\"hljs-comment\">/* some markup */</span>\n         {<span class=\"hljs-module-identifier\">Param</span>.render(state.value)} &lt;/div&gt;,\n  };\n};\n</code></pre>\n<p>Now, in order to create a component, we just have to create a module with <code>Make</code>:</p>\n<pre><code class=\"language-reason\"><span class=\"hljs-keyword\">module</span> <span class=\"hljs-module-identifier\">IntValue</span> =\n  <span class=\"hljs-module-identifier\">Make</span>({\n    <span class=\"hljs-keyword\">type</span> t = int;\n    <span class=\"hljs-keyword\">let</span> name = <span class=\"hljs-string\">&quot;Int&quot;</span>;\n    <span class=\"hljs-keyword\">let</span> render = x =&gt; x<span class=\"hljs-operator\">-&gt;</span>string_of_int<span class=\"hljs-operator\">-&gt;</span><span class=\"hljs-module-identifier\">React</span>.string;\n  });\n\n<span class=\"hljs-module-identifier\">ReactDOMRe</span>.renderToElementWithId(&lt;<span class=\"hljs-module-identifier\">IntValue</span> value=<span class=\"hljs-number\">2</span> /&gt;, <span class=\"hljs-string\">&quot;preview&quot;</span>);\n</code></pre>\n<p><a href=\"https://reasonml.github.io/en/try?rrjsx=true&amp;reason=LYewJgrgNgpgBAFwJ4Ad4AUCGAnTwAqq8AvHAN4BQciRiA3FXLAnAHZ4wBccAzgtgEtWAcwbVmcbDFZgY2bi2IA+OACUYmHiFbrMAYwQA6KfoQBRWMGkIGAXwYVQkWHACymANYk4ACiy5gbn88QjQASjhlckZkNF4ETARvMgA3TCgILjhg4EMEe0YJPRBgFG1rSLUNLR0NA2MYSD05AGESstZrHwAiABEYUG64AGph7Jw8Q3YrMLEmGBZgT28fAD80jKycvIAaOAB9CKjKampDc+LS8tYEHcZqIQEEAXSAZQSk7h8jlVT0zO4G0ytjup0kjQgzXkvm+e32fESMB+VU02l09QAciAAKooMCI0GnKQyORfMgIpK2H73U4AHjAAhS8SQsGIZHRCF6AHlXOpDO8WTBDEsvGsAGbaBCvAQALxgxG6AGYAEwoAAe3T23zCtiUNLBAHoAFS8ErwJbYDwQFBwI0G-VgsjbYmybA+ClCoFI2xwWkGhkpJSEgoFJzQeAASRuADV-iRGO5RSdTrF4Io4EIbDSJNNvN0owhunNxAtwSTsJU1ZEVGqALRKPiCET7EBi-aZ+u6GocwyNoSiRhUhwc7m8oUuuT4EAWAbWADqTwAFhGwD5aQXY5s4F7iMq4Aag3BuigpCkBDAAO7dWYUIA\">Test it on the ReasonML playground</a></p>\n"}}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"h":1,"l":{"RE_PRIVATE_NONE":true},"r":{"RE_PRIVATE_NONE":true}},"listsRequests":{"data":{"RE_PRIVATE_NONE":true}},"itemsRequests":{"data":{"RE_PRIVATE_NONE":true}}}</script><script defer="defer" src="/public/main.fdc85e74f1c7cc1738ce.js"></script></html>